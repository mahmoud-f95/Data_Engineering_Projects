[2024-01-16T12:46:13.401+0200] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: execute_python_pipeline.remove_nulls manual__2024-01-16T10:46:08.225228+00:00 [queued]>
[2024-01-16T12:46:13.405+0200] {taskinstance.py:1957} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: execute_python_pipeline.remove_nulls manual__2024-01-16T10:46:08.225228+00:00 [queued]>
[2024-01-16T12:46:13.406+0200] {taskinstance.py:2171} INFO - Starting attempt 1 of 1
[2024-01-16T12:46:13.422+0200] {taskinstance.py:2192} INFO - Executing <Task(PythonOperator): remove_nulls> on 2024-01-16 10:46:08.225228+00:00
[2024-01-16T12:46:13.425+0200] {standard_task_runner.py:60} INFO - Started process 12354 to run task
[2024-01-16T12:46:13.429+0200] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'execute_python_pipeline', 'remove_nulls', 'manual__2024-01-16T10:46:08.225228+00:00', '--job-id', '105', '--raw', '--subdir', 'DAGS_FOLDER/executing_python_pipeline.py', '--cfg-path', '/tmp/tmp13k_deq7']
[2024-01-16T12:46:13.431+0200] {standard_task_runner.py:88} INFO - Job 105: Subtask remove_nulls
[2024-01-16T12:46:13.464+0200] {task_command.py:423} INFO - Running <TaskInstance: execute_python_pipeline.remove_nulls manual__2024-01-16T10:46:08.225228+00:00 [running]> on host DESKTOP-9NHC01K.
[2024-01-16T12:46:13.521+0200] {taskinstance.py:2481} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='execute_python_pipeline' AIRFLOW_CTX_TASK_ID='remove_nulls' AIRFLOW_CTX_EXECUTION_DATE='2024-01-16T10:46:08.225228+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-01-16T10:46:08.225228+00:00'
[2024-01-16T12:46:13.533+0200] {logging_mixin.py:188} WARNING - /home/mahmoud/airflow/dags/executing_python_pipeline.py:17 FutureWarning: Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.
[2024-01-16T12:46:13.565+0200] {logging_mixin.py:188} INFO -        age     sex     bmi  children smoker     region      charges
0     19.0  female  27.900       0.0    yes  southwest  16884.92400
1     18.0    male  33.770       1.0     no  southeast   1725.55230
2     28.0    male  33.000       3.0     no  southeast   4449.46200
4     25.0    male  28.600       1.0     no  southeast   3366.66970
5     33.0    male  22.705       0.0     no  northwest  21984.47061
...    ...     ...     ...       ...    ...        ...          ...
1343  61.0  female  29.070       0.0    yes  northwest  29141.36030
1344  18.0  female  31.920       0.0     no  northeast   2205.98080
1345  18.0  female  36.850       0.0     no  southeast   1629.83350
1346  21.0  female  25.800       0.0     no  southwest   2007.94500
1348  42.0    male  35.120       0.0     no  southwest   5976.83110

[1345 rows x 7 columns]
[2024-01-16T12:46:13.565+0200] {python.py:201} INFO - Done. Returned value was: <bound method NDFrame.to_json of        age     sex     bmi  children smoker     region      charges
0     19.0  female  27.900       0.0    yes  southwest  16884.92400
1     18.0    male  33.770       1.0     no  southeast   1725.55230
2     28.0    male  33.000       3.0     no  southeast   4449.46200
4     25.0    male  28.600       1.0     no  southeast   3366.66970
5     33.0    male  22.705       0.0     no  northwest  21984.47061
...    ...     ...     ...       ...    ...        ...          ...
1343  61.0  female  29.070       0.0    yes  northwest  29141.36030
1344  18.0  female  31.920       0.0     no  northeast   2205.98080
1345  18.0  female  36.850       0.0     no  southeast   1629.83350
1346  21.0  female  25.800       0.0     no  southwest   2007.94500
1348  42.0    male  35.120       0.0     no  southwest   5976.83110

[1345 rows x 7 columns]>
[2024-01-16T12:46:13.597+0200] {xcom.py:664} ERROR - Object of type method is not JSON serializable. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your airflow config or make sure to decorate your object with attr.
[2024-01-16T12:46:13.598+0200] {taskinstance.py:2699} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/utils/json.py", line 91, in default
    return serialize(o)
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/serialization/serde.py", line 180, in serialize
    raise TypeError(f"cannot serialize object of type {cls}")
TypeError: cannot serialize object of type <class 'method'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 440, in _execute_task
    task_instance.xcom_push(key=XCOM_RETURN_KEY, value=xcom_value, session=session)
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 2981, in xcom_push
    XCom.set(
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/models/xcom.py", line 247, in set
    value = cls.serialize_value(
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/models/xcom.py", line 662, in serialize_value
    return json.dumps(value, cls=XComEncoder).encode("UTF-8")
  File "/usr/lib/python3.10/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/utils/json.py", line 104, in encode
    return super().encode(o)
  File "/usr/lib/python3.10/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.10/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/mahmoud/airflow_env/lib/python3.10/site-packages/airflow/utils/json.py", line 93, in default
    return super().default(o)
  File "/usr/lib/python3.10/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type method is not JSON serializable
[2024-01-16T12:46:13.602+0200] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=execute_python_pipeline, task_id=remove_nulls, execution_date=20240116T104608, start_date=20240116T104613, end_date=20240116T104613
[2024-01-16T12:46:13.616+0200] {standard_task_runner.py:107} ERROR - Failed to execute job 105 for task remove_nulls (Object of type method is not JSON serializable; 12354)
[2024-01-16T12:46:13.642+0200] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-01-16T12:46:13.654+0200] {taskinstance.py:3281} INFO - 0 downstream tasks scheduled from follow-on schedule check
